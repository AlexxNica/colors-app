/* global: mojs */

// add custom `copy` shape
class Copy extends mojs.CustomShape {
  getShape() {
    return '<path d="M12.245263,71.4855119 L12.245263,7.67307701 C12.245263,5.68723732 13.9278022,4.24573469 15.9136419,4.24573469 L51.9917736,4.24573469 C53.3540313,4.24573469 54.226197,5.69572785 54.226197,7.17590955 L54.226197,7.62354895 L54.226197,10.1909897 L54.226197,14.8546469 C54.226197,15.4654931 54.387517,16.023981 54.6639308,16.5093561 L71.3317767,16.5093561 C70.980835,15.3098334 70.3648002,14.2027632 69.4723515,13.2744657 L59.0157971,2.44149792 C57.4728798,0.836788506 55.35072,0 53.1243155,0 L15.9136419,0 C11.5905491,0.000471695888 8,3.3499842 8,7.67307701 L8,71.4855119 C8,75.8086047 11.5905491,79.2453809 15.9136419,79.2453809 L25.4527479,79.2453809 L25.4527479,75.0001179 L15.9136419,75.0001179 C13.9278022,75.0001179 12.245263,73.4708799 12.245263,71.4855119 Z M90.5764973,33.7842746 L80.0586224,22.8380998 C78.5157051,21.2333904 76.3322248,20.2833949 74.1058203,20.2833949 L36.894675,20.2833949 C32.5715822,20.2833949 29.226315,23.8593214 29.226315,28.1824142 L29.226315,91.9953208 C29.226315,96.3184136 32.5715822,100 36.894675,100 L84.9788822,100 C89.301975,100 92.9052599,96.3184136 92.9052599,91.9953208 L92.9052599,39.4601912 C92.9052599,37.3333145 92.0505469,35.3177579 90.5764973,33.7842746 Z M88.6599969,91.9953208 C88.6599969,93.9806888 86.9647219,95.754737 84.9788822,95.754737 L36.894675,95.754737 C34.909307,95.754737 33.471578,93.9806888 33.471578,91.9953208 L33.471578,28.1824142 C33.471578,26.1965745 34.909307,24.5286579 36.894675,24.5286579 L72.9728067,24.5286579 C74.3350645,25.0003538 75.452512,26.2050651 75.452512,27.6852468 L75.452512,28.1328862 L75.452512,30.7003269 L75.452512,35.3639841 C75.452512,37.4252952 77.0076934,39.1507587 79.0690044,39.1507587 L82.3737058,39.1507587 L84.9090712,39.1507587 L85.3892576,39.1507587 C87.0227405,39.1507587 88.1887727,40.3149042 88.6604686,41.8913118 L88.6604686,91.9953208 L88.6599969,91.9953208 Z"></path>';
  }
}
mojs.addShape('copy', Copy);

export function addModules(timeline, el) {
  const ShapeStagger = mojs.stagger( mojs.Shape );

  const ripplesOut = new ShapeStagger({
    parent:     el,
    left: 0, top: 0,
    quantifier: 3,
    fill:       'none',
    stroke:     ['white', '#999', '#f1f1f1'],
    opacity:    { [.2] : 0 },
    scale:      { 0: 5 },
    delay:      'stagger(150, 75)',
    duration:   1000
  });

  const copyShape = new mojs.Shape({
    shape:    'copy',
    parent:   el,
    left: 0, top: 0,
    radius:   30,
    scale:    { 0: 1 },
    opacity:  { 1.5: -.1, easing: 'quad.inout' },
    fill:     'white',
    duration: 500,
    delay:    350,
  });

  const ripplesIn = new ShapeStagger({
    parent:     el,
    left: 0, top: 0,
    quantifier: 3,
    delay:      'stagger(100)',
    fill:       ['hotpink', 'cyan', 'yellow'],
    // fill:       ['white', '#999', '#f1f1f1'],
    opacity:    { [.75] : 0 },
    scale:      { 'stagger(20, -5)': 0 }
  });

  timeline.add(ripplesOut, ripplesIn, copyShape);
  return [ripplesOut, ripplesIn, copyShape];
}

export function tuneModules(modules, x, y) {
  for (let i = 0; i < modules.length; i++) {
      modules[i].tune({ x, y });
  }
}
